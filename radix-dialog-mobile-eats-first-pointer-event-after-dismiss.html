<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><title>Issue: Radix Dialog on Mobile eats first pointer event after dismiss</title><meta name="description" content="Issue: Radix Dialog on Mobile eats first pointer event after dismiss"/><meta name="next-head-count" content="4"/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/minimal-repros/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/minimal-repros/_next/static/chunks/webpack-9a674e34aede76e0.js" defer=""></script><script src="/minimal-repros/_next/static/chunks/framework-91d7f78b5b4003c8.js" defer=""></script><script src="/minimal-repros/_next/static/chunks/main-629582258d0e4696.js" defer=""></script><script src="/minimal-repros/_next/static/chunks/pages/_app-d821886ca7955871.js" defer=""></script><script src="/minimal-repros/_next/static/chunks/442-c2bc69bf319e5b85.js" defer=""></script><script src="/minimal-repros/_next/static/chunks/pages/radix-dialog-mobile-eats-first-pointer-event-after-dismiss-10dacaae99059cd7.js" defer=""></script><script src="/minimal-repros/_next/static/lZHdUQPka6ceLfugFBSFt/_buildManifest.js" defer=""></script><script src="/minimal-repros/_next/static/lZHdUQPka6ceLfugFBSFt/_ssgManifest.js" defer=""></script><script src="/minimal-repros/_next/static/lZHdUQPka6ceLfugFBSFt/_middlewareManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><div><a href="/minimal-repros">Back to Home</a><h2>Issue: Radix Dialog on Mobile eats first pointer event after dismiss</h2><ol><li>View the source code for this pageÂ <a href="https://github.com/just-learning-1/minimal-repros/blob/master/src/pages/radix-dialog-mobile-eats-first-pointer-event-after-dismiss.page.jsx">here</a></li><li>Open this page in a mobile browser or in Firefox with Touch Emulation enabled</li><li>Tap the following button to open the Radix UI Dialog:</li><li><button type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="" data-state="closed">#1: First tap after dismiss is eaten</button></li><li>After dismissing the dialog, try tapping the same (or a different) button again</li><li><strong>Result: </strong>The first tap after dismissing the dialog is stolen!</li><li><strong>Investigation: </strong>I discovered the following is still set on the body tag after dismiss until the next tap is received:<br/><code>&lt;body style=&quot;pointer-events: none;&quot;&gt;</code></li><li><strong>However! </strong>If I change the implementation of<strong> DialogContent </strong>from this:</li><li><pre style="display:block;overflow-x:auto;padding:0.5em;background:#F0F0F0;color:#444"><code class="language-javascript" style="white-space:pre"><span style="color:#888888">// from this page</span><span>
</span>&lt;Dialog&gt;
<span>  </span><span class="xml hljs-tag">&lt;</span><span class="xml hljs-tag" style="font-weight:bold">DialogTrigger</span><span class="xml hljs-tag"> </span><span class="xml hljs-tag hljs-attr">asChild</span><span class="xml hljs-tag">&gt;</span><span class="xml">
</span><span class="xml">    </span><span class="xml hljs-tag">&lt;</span><span class="xml hljs-tag" style="font-weight:bold">button</span><span class="xml hljs-tag"> </span><span class="xml hljs-tag hljs-attr">type</span><span class="xml hljs-tag">=</span><span class="xml hljs-tag" style="color:#880000">&quot;button&quot;</span><span class="xml hljs-tag">&gt;</span><span class="xml">
</span><span class="xml">      Tap Me, then Tap Me Again after dismissing the dialog
</span><span class="xml">    </span><span class="xml hljs-tag">&lt;/</span><span class="xml hljs-tag" style="font-weight:bold">button</span><span class="xml hljs-tag">&gt;</span><span class="xml">
</span><span class="xml">  </span><span class="xml hljs-tag">&lt;/</span><span class="xml hljs-tag" style="font-weight:bold">DialogTrigger</span><span class="xml hljs-tag">&gt;</span><span>
</span><span>  </span><span class="xml hljs-tag">&lt;</span><span class="xml hljs-tag" style="font-weight:bold">DialogContent</span><span class="xml hljs-tag">&gt;</span><span class="xml">
</span><span class="xml">    Now dismiss this dialog, then try tapping the earlier button again
</span><span class="xml">  </span><span class="xml hljs-tag">&lt;/</span><span class="xml hljs-tag" style="font-weight:bold">DialogContent</span><span class="xml hljs-tag">&gt;</span><span>
</span>&lt;/Dialog&gt;
<!-- -->
<span></span><span style="color:#888888">// from Dialog.jsx</span><span>
</span><span></span><span style="font-weight:bold">export</span><span> </span><span style="font-weight:bold">const</span><span> DialogContent = React.forwardRef(</span><span class="hljs-function">(</span><span class="hljs-function hljs-params">{ children, ...props }, forwardedRef</span><span class="hljs-function">) =&gt;</span><span> (
</span><span>  </span><span class="xml hljs-tag">&lt;</span><span class="xml hljs-tag" style="font-weight:bold">DialogContentContainer</span><span class="xml hljs-tag"> {</span><span class="xml hljs-tag hljs-attr">...props</span><span class="xml hljs-tag">} </span><span class="xml hljs-tag hljs-attr">ref</span><span class="xml hljs-tag">=</span><span class="xml hljs-tag" style="color:#880000">{forwardedRef}</span><span class="xml hljs-tag">&gt;</span><span class="xml">
</span><span class="xml">    </span><span class="xml hljs-tag">&lt;</span><span class="xml hljs-tag" style="font-weight:bold">DialogHeaderBar</span><span class="xml hljs-tag">&gt;</span><span class="xml">
</span><span class="xml">      </span><span class="xml hljs-tag">&lt;</span><span class="xml hljs-tag" style="font-weight:bold">CloseButton</span><span class="xml hljs-tag"> </span><span class="xml hljs-tag hljs-attr">aria-label</span><span class="xml hljs-tag">=</span><span class="xml hljs-tag" style="color:#880000">&quot;close&quot;</span><span class="xml hljs-tag"> </span><span class="xml hljs-tag hljs-attr">asChild</span><span class="xml hljs-tag">&gt;</span><span class="xml">
</span><span class="xml">        </span><span class="xml hljs-tag">&lt;</span><span class="xml hljs-tag" style="font-weight:bold">button</span><span class="xml hljs-tag"> </span><span class="xml hljs-tag hljs-attr">type</span><span class="xml hljs-tag">=</span><span class="xml hljs-tag" style="color:#880000">&quot;button&quot;</span><span class="xml hljs-tag">&gt;</span><span class="xml">
</span><span class="xml">          Dismiss
</span><span class="xml">        </span><span class="xml hljs-tag">&lt;/</span><span class="xml hljs-tag" style="font-weight:bold">button</span><span class="xml hljs-tag">&gt;</span><span class="xml">
</span><span class="xml">      </span><span class="xml hljs-tag">&lt;/</span><span class="xml hljs-tag" style="font-weight:bold">CloseButton</span><span class="xml hljs-tag">&gt;</span><span class="xml">
</span><span class="xml">    </span><span class="xml hljs-tag">&lt;/</span><span class="xml hljs-tag" style="font-weight:bold">DialogHeaderBar</span><span class="xml hljs-tag">&gt;</span><span class="xml">
</span><span class="xml">    </span><span class="xml hljs-tag">&lt;</span><span class="xml hljs-tag" style="font-weight:bold">DialogContentBody</span><span class="xml hljs-tag">&gt;</span><span class="xml">
</span><span class="xml">      {children}
</span><span class="xml">    </span><span class="xml hljs-tag">&lt;/</span><span class="xml hljs-tag" style="font-weight:bold">DialogContentBody</span><span class="xml hljs-tag">&gt;</span><span class="xml">
</span><span class="xml">  </span><span class="xml hljs-tag">&lt;/</span><span class="xml hljs-tag" style="font-weight:bold">DialogContentContainer</span><span class="xml hljs-tag">&gt;</span><span>
</span>))</code></pre></li><li>To this:</li><li><pre style="display:block;overflow-x:auto;padding:0.5em;background:#F0F0F0;color:#444"><code class="language-javascript" style="white-space:pre"><span style="color:#888888">// from this page</span><span>
</span>&lt;Dialog&gt;
<span>  </span><span class="xml hljs-tag">&lt;</span><span class="xml hljs-tag" style="font-weight:bold">DialogTrigger</span><span class="xml hljs-tag"> </span><span class="xml hljs-tag hljs-attr">asChild</span><span class="xml hljs-tag">&gt;</span><span class="xml">
</span><span class="xml">    </span><span class="xml hljs-tag">&lt;</span><span class="xml hljs-tag" style="font-weight:bold">button</span><span class="xml hljs-tag"> </span><span class="xml hljs-tag hljs-attr">type</span><span class="xml hljs-tag">=</span><span class="xml hljs-tag" style="color:#880000">&quot;button&quot;</span><span class="xml hljs-tag">&gt;</span><span class="xml">
</span><span class="xml">      Here is a second button whose pointer event also gets eaten
</span><span class="xml">    </span><span class="xml hljs-tag">&lt;/</span><span class="xml hljs-tag" style="font-weight:bold">button</span><span class="xml hljs-tag">&gt;</span><span class="xml">
</span><span class="xml">  </span><span class="xml hljs-tag">&lt;/</span><span class="xml hljs-tag" style="font-weight:bold">DialogTrigger</span><span class="xml hljs-tag">&gt;</span><span>
</span><span>  </span><span class="xml hljs-tag">&lt;</span><span class="xml hljs-tag" style="font-weight:bold">DialogPrimitive.Content</span><span class="xml hljs-tag"> </span><span class="xml hljs-tag hljs-attr">style</span><span class="xml hljs-tag">=</span><span class="xml hljs-tag" style="color:#880000">{{</span><span class="xml hljs-tag"> /* </span><span class="xml hljs-tag hljs-attr">...</span><span class="xml hljs-tag"> */ }}&gt;</span><span class="xml">
</span><span class="xml">    </span><span class="xml hljs-tag">&lt;</span><span class="xml hljs-tag" style="font-weight:bold">DialogPrimitive.Close</span><span class="xml hljs-tag"> </span><span class="xml hljs-tag hljs-attr">asChild</span><span class="xml hljs-tag">&gt;</span><span class="xml">
</span><span class="xml">      </span><span class="xml hljs-tag">&lt;</span><span class="xml hljs-tag" style="font-weight:bold">button</span><span class="xml hljs-tag"> </span><span class="xml hljs-tag hljs-attr">type</span><span class="xml hljs-tag">=</span><span class="xml hljs-tag" style="color:#880000">&quot;button&quot;</span><span class="xml hljs-tag">&gt;</span><span class="xml">Dismiss</span><span class="xml hljs-tag">&lt;/</span><span class="xml hljs-tag" style="font-weight:bold">button</span><span class="xml hljs-tag">&gt;</span><span class="xml">
</span><span class="xml">    </span><span class="xml hljs-tag">&lt;/</span><span class="xml hljs-tag" style="font-weight:bold">DialogPrimitive.Close</span><span class="xml hljs-tag">&gt;</span><span class="xml">
</span><span class="xml">    Now dismiss this dialog, then try tapping the earlier button again
</span><span class="xml">    </span><span class="xml hljs-tag">&lt;/</span><span class="xml hljs-tag" style="font-weight:bold">DialogPrimitive.Content</span><span class="xml hljs-tag">&gt;</span><span>
</span>&lt;/Dialog&gt;</code></pre></li><li>Like so:<br/><button type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="" data-state="closed">#2: Stolen tap is fixed! But I do not understand why</button></li><li><strong>The problem goes away! </strong>The first tap after dismiss is not invalidated.</li><li>Only difference is the second version swaps a<code> React.forwardRef </code>styled version of the Dialog Content element with the<code> DialogPrimitive.Content </code>element directly</li><li>The curious thing is, the implementation of the first dialog is modeled almost identically to the<strong> Radix UI Design System Dialog. </strong>Compare the two Dialog implementations:<ol><ol><a href="https://github.com/radix-ui/design-system/blob/master/components/Dialog.tsx">radix-ui/design-system/.../Dialog.tsx</a></ol><ol><a href="https://github.com/just-learning-1/minimal-repros/blob/master/src/base/Dialog.jsx">just-learning-1/minimal-repros/.../Dialog.jsx</a></ol></ol></li><li>I am new to coding, and I cannot for the life of me figure out why this is happening :(</li></ol></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{}},"page":"/radix-dialog-mobile-eats-first-pointer-event-after-dismiss","query":{},"buildId":"lZHdUQPka6ceLfugFBSFt","assetPrefix":"/minimal-repros","nextExport":true,"autoExport":true,"isFallback":false,"scriptLoader":[]}</script></body></html>